
> Sticky Session은 주로 Elastic Load Balancing (ELB) 서비스에서 사용되는 기능이다. 이 기능은 특정 사용자의 세션을 동일한 백엔드 인스턴스(예: EC2 인스턴스)에 지속적으로 라우팅하여 일관된 사용자 경험을 제공하는 데 도움이 된다. 이를 통해 사용자는 세션 동안 동일한 인스턴스로부터 서비스를 받게 된다. Sticky Session은 "session affinity"라고도 불린다.

### Sticky Session의 작동 원리 
1. 초기 요청 처리: 사용자가 처음으로 웹 애플리케이션에 요청을 보낼 때, 로드 밸런서는 사용 가능한 백엔드 인스턴스 중 하나를 선택하여 요청을 전달한다.


2. 세션 식별자 생성: 로드 밸런서는 해당 세션을 식별하기 위해 사용자의 세션에 특정 식별자(쿠키)를 할당한다. 이 쿠키는 사용자의 브라우저에 저장되며, 사용자가 다음 요청을 할 때 함께 전송된다.


3. 요청 라우팅: 사용자가 추가 요청을 할 때마다 로드 밸런서는 쿠키를 통해 해당 사용자의 세션을 인식하고, 모든 요청을 최초에 선택된 동일한 백엔드 인스턴스로 라우팅한다.

### Sticky Session의 장단점
- **장점** 
  - **상태 유지**: 세션 데이터를 로컬로 저장하고 관리하는 애플리케이션에서 유용하며, 서버 간 세션 데이터의 동기화 필요성을 줄일 수 있다.
  - **사용자 경험 개선**: 사용자의 상호작용을 보다 일관되게 처리하여, 애플리케이션의 반응성과 사용자 만족도를 향상시킬 수 있다.


- **단점**
  - **균형 잡힌 트래픽 분산 제한**: 특정 서버에 사용자 세션이 고정되면, 일부 서버에 부하가 집중될 수 있어 로드 밸런서의 효율성이 감소할 수 있다.
  - **확장성 문제**: 애플리케이션의 사용자 수가 급증하는 경우, 세션을 고정된 서버로만 보내면서 트래픽 분산이 제대로 이루어지지 않을 수 있다.
  - **장애 복구의 복잡성 증가**: 세션이 특정 서버에 고정되어 있기 때문에, 해당 서버에 문제가 생겼을 때 세션 정보의 복원과 재배치가 필요할 수 있다.

### 설정방법

대상그룹 -> 대상그룹 선택, 작업 -> 대상 그룹 속성 편집 -> 고정 활성화 

### 쿠키 종류

- **로드 밸런서 생성 쿠키 (Load Balancer Generated Cookie)**<br><br>
  - **동작 방식**: 로드 밸런서는 사용자 세션에 대해 자동으로 쿠키를 생성하고 관리한다. 이 쿠키는 AWSALB 또는 AWSALBAPP 등의 이름으로 자동 생성되며, 로드 밸런서가 클라이언트와 타겟 사이의 세션을 추적하는 데 사용된다.<br><br>
  - **사용자 설정**: 사용자는 쿠키의 만료 시간만 설정할 수 있으며, 그 외의 쿠키 이름이나 값은 로드 밸런서에 의해 자동으로 처리된다. 이는 서버에 부하가 많은 경우나 사용자가 쿠키 구성을 간소화하고 싶은 경우 유용하다.


- **어플리케이션 기반 쿠키 (Application-based Cookie)**<br><br>
  - **동작 방식**: 어플리케이션 자체에서 쿠키를 생성하고 관리한다. 로드 밸런서는 어플리케이션에서 설정한 쿠키를 인식하여 그 쿠키를 기반으로 사용자 요청을 동일한 타겟으로 라우팅한다.<br><br>
  - **사용자 설정**: 사용자는 쿠키의 이름과 값을 직접 설정할 수 있다. 이는 어플리케이션이 이미 세션 관리를 위해 쿠키를 사용하고 있고, 이를 기반으로 로드 밸런싱을 구현하고자 할 때 유용하다. 예를 들어, 로그인 세션을 유지하기 위한 쿠키 등을 이용할 수 있다.
